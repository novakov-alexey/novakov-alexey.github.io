<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <meta content="#ffffff" name="theme-color" />
  <meta content="#da532c" name="msapplication-TileColor" />

  
  
  
  
  

  <link href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/galleria/1.6.1/themes/folio/galleria.folio.min.css"
    rel="stylesheet" />
  <link href="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.css" rel="stylesheet" />
  <link href='https://novakov-alexey.github.io/site.css' rel="stylesheet" />

  
  

  <title>
    
Alexey Novakov Notes | Cats-Effect: Cancel Scala Process on Timeout

  </title>

  <script crossorigin="anonymous" src="https://kit.fontawesome.com/201b8d5e05.js"></script>

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-49N5BCWL0F"></script>
  <script type="text/javascript">
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());
    gtag("config", "G-49N5BCWL0F");
  </script>
  
</head>

<body class="has-background-white">
  
  <nav aria-label="section navigation" class="navbar is-light" role="navigation">
    <div class="container">
      <div class="navbar-brand">
        <a class="navbar-item has-text-weight-bold" href="https:&#x2F;&#x2F;novakov-alexey.github.io">Alexey Novakov Notes</a>
        <a aria-expanded="false" aria-label="menu" class="navbar-burger burger" data-target="navMenu" role="button">
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
      </div>
      <div class="navbar-menu" id="navMenu">
        <div class="navbar-end has-text-centered">
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;'>
            Blog
          </a>
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;cv'>
            CV
          </a>
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;presentations'>
            Presentations
          </a>
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;tags'>
            Tags
          </a>
          
          <a class="navbar-item" href='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;categories'>
            Categories
          </a>
          
          <a class="navbar-item" id="nav-search" title="Search" data-target="#search-modal">
            <span class="icon">
              <i class="fas fa-search"></i>
            </span>
          </a>
          <a class="navbar-item" id="dark-mode" title="Switch to dark theme">
            <span class="icon">
              <i class="fas fa-adjust"></i>
            </span>
          </a>
        </div>
      </div>
    </div>
  </nav>
  

  
  

  
<section class="section">
  <div class="container">
    <div class="columns">
      <div class="column is-8 is-offset-2">
        <article class="box">
          <h1 class="title is-1">
            Cats-Effect: Cancel Scala Process on Timeout
          </h1>
          <p class="subtitle"></p>
          <div class="columns is-multiline is-gapless">
            <div class="column is-8">
              
  <p class="has-text-grey">
    <span class="icon">
      <i class="fas fa-user"></i>
    </span>
    Alexey Novakov published on
    <span class="icon">
      <i class="far fa-calendar-alt"></i>
    </span>
    <time datetime='2020-02-29'>February 29, 2020</time>
  </p>

            </div>
            <div class="column is-4 has-text-right-desktop">
              
  <p class="has-text-grey">
    <span class="icon">
      <i class="far fa-clock"></i>
    </span>
    3 min,
    <span class="icon">
      <i class="fas fa-pencil-alt"></i>
    </span>
    540 words
  </p>

            </div>
            <div class="column">
              
              
  <p>
    <span class="has-text-black has-text-weight-normal">Categories:</span>
    
      <a class="link has-text-weight-light" href='https://novakov-alexey.github.io/categories/scala/'>
        <span class="icon is-small">
          <i class="fas fa-folder fa-xs"></i>
        </span>
        scala
      </a>
    
  </p>

              
            </div>
            <div class="column has-text-right-desktop">
              
              
  <p>
    <span class="has-text-black has-text-weight-normal">Tags:</span>
    
      <a class="link has-text-weight-light" href='https://novakov-alexey.github.io/tags/fp/'>
        <span class="icon is-small">
          <i class="fas fa-tag fa-xs"></i>
        </span>
        fp
      </a>
    
      <a class="link has-text-weight-light" href='https://novakov-alexey.github.io/tags/cats-effect/'>
        <span class="icon is-small">
          <i class="fas fa-tag fa-xs"></i>
        </span>
        cats-effect
      </a>
    
  </p>

              
            </div>
          </div>
          <div class="content mt-2 has-text-justified">
            

<img src="https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;processed_images&#x2F;maico-amorim.4a1fab892b675107.jpg" class="center-image"/>
<br/><br/>
<p>Sometimes Scala developer needs to call external program, which is running outside of the JVM.
In this case, we use <code>scala.sys.process</code> package. Process package has bunch of functions to spin up new processes,
consume their outputs and errors. Also, spawned process can be stopped. Usually, we run external programs for a short period
of time to make some side-effect. Then, we analyse its exit code to apply some error handling logic in our main Scala program.
It worth to say that process API is blocking execution thread, when we are waiting for its completion. To summarise, Scala
developer wants to do the following:</p>
<span id="continue-reading"></span>
<ol>
<li>Start external program as a process by giving a string containing command to be executed in underlying operating system.</li>
<li>Wait for completion and get the exit code.</li>
<li>Cancel spawned process, in case waiting time for its completion is greater than a certain threshold.</li>
</ol>
<p>Good news, we can do all of that in Cats-Effect leveraging IO monad to handle a side-effect and having timeout logic around.</p>
<h2 id="handle-blocking-code">Handle blocking code</h2>
<p>Besides usual <code>ContextShift</code>, we will use separate thread pool to run blocking code of process API.
Cats-Effect provides <code>Blocker</code> class to evaluate specific IO on a given execution context. In case below, we are going
to use CachedThreadPool, which can grow almost infinitely. Our main execution context will be still <code>ExecutionContext.global</code>
and it will be used for non-blocking operations.</p>
<pre data-lang="scala" style="background-color:#2e3440;color:#d8dee9;" class="language-scala "><code class="language-scala" data-lang="scala"><span>
</span><span style="color:#81a1c1;">import</span><span> java</span><span style="color:#81a1c1;">.</span><span>util</span><span style="color:#81a1c1;">.</span><span>concurrent</span><span style="color:#81a1c1;">.</span><span>Executors
</span><span style="color:#81a1c1;">import</span><span> java</span><span style="color:#81a1c1;">.</span><span>util</span><span style="color:#81a1c1;">.</span><span>concurrent</span><span style="color:#81a1c1;">.</span><span>TimeoutException
</span><span>
</span><span style="color:#81a1c1;">import</span><span> cats</span><span style="color:#81a1c1;">.</span><span>effect</span><span style="color:#81a1c1;">.</span><span>ExitCase</span><span style="color:#81a1c1;">._
</span><span style="color:#81a1c1;">import</span><span> cats</span><span style="color:#81a1c1;">.</span><span>effect</span><span style="color:#81a1c1;">.</span><span>{Blocker</span><span style="color:#eceff4;">,</span><span> Concurrent</span><span style="color:#eceff4;">,</span><span> ContextShift</span><span style="color:#eceff4;">,</span><span> IO</span><span style="color:#eceff4;">,</span><span> Timer}
</span><span style="color:#81a1c1;">import</span><span> cats</span><span style="color:#81a1c1;">.</span><span>implicits</span><span style="color:#81a1c1;">._
</span><span>
</span><span style="color:#81a1c1;">import</span><span> scala</span><span style="color:#81a1c1;">.</span><span>concurrent</span><span style="color:#81a1c1;">.</span><span>ExecutionContext
</span><span style="color:#81a1c1;">import</span><span> scala</span><span style="color:#81a1c1;">.</span><span>concurrent</span><span style="color:#81a1c1;">.</span><span>duration</span><span style="color:#81a1c1;">._
</span><span style="color:#81a1c1;">import</span><span> scala</span><span style="color:#81a1c1;">.</span><span>sys</span><span style="color:#81a1c1;">.</span><span>process</span><span style="color:#81a1c1;">._
</span><span>
</span><span style="color:#81a1c1;">implicit val timer</span><span>: </span><span style="color:#8fbcbb;">Timer</span><span>[</span><span style="color:#8fbcbb;">IO</span><span>] </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">IO</span><span style="color:#81a1c1;">.</span><span>timer(</span><span style="color:#8fbcbb;">ExecutionContext</span><span style="color:#81a1c1;">.</span><span>global)
</span><span style="color:#81a1c1;">implicit val cs</span><span>: </span><span style="color:#8fbcbb;">ContextShift</span><span>[</span><span style="color:#8fbcbb;">IO</span><span>] </span><span style="color:#81a1c1;">= </span><span style="color:#8fbcbb;">IO</span><span style="color:#81a1c1;">.</span><span>contextShift(</span><span style="color:#8fbcbb;">ExecutionContext</span><span style="color:#81a1c1;">.</span><span>global)
</span><span>
</span><span style="color:#81a1c1;">val cachedThreadPool = </span><span style="color:#8fbcbb;">Executors</span><span style="color:#81a1c1;">.</span><span>newCachedThreadPool()
</span><span style="color:#81a1c1;">val blocker = </span><span style="color:#8fbcbb;">Blocker</span><span style="color:#81a1c1;">.</span><span>liftExecutionContext(
</span><span>    </span><span style="color:#8fbcbb;">ExecutionContext</span><span style="color:#81a1c1;">.</span><span>fromExecutor(cachedThreadPool)
</span><span>)
</span><span>
</span></code></pre>
<h2 id="blocking-task">Blocking Task</h2>
<p><code>Blocker</code> has <code>blockOn</code> method, which takes an IO and returns an IO to be evaluated on the specified earlier thread pool.</p>
<pre data-lang="scala" style="background-color:#2e3440;color:#d8dee9;" class="language-scala "><code class="language-scala" data-lang="scala"><span style="color:#81a1c1;">def </span><span style="color:#88c0d0;">startProcess</span><span>(cmd: </span><span style="color:#8fbcbb;">String</span><span>): </span><span style="color:#8fbcbb;">IO</span><span>[</span><span style="color:#81a1c1;">Int</span><span>] </span><span style="color:#81a1c1;">= </span><span>{
</span><span>  </span><span style="color:#81a1c1;">val blockingTask =</span><span> blocker</span><span style="color:#81a1c1;">.</span><span>blockOn(</span><span style="color:#8fbcbb;">IO</span><span>(cmd</span><span style="color:#81a1c1;">.</span><span>run()))
</span><span>
</span><span>  </span><span style="color:#616e88;">//.... tbd
</span><span>}
</span><span>
</span></code></pre>
<p>Using Cats-Effect <a href="https://typelevel.org/cats-effect/typeclasses/bracket.html">Bracket</a> type class we can safely start our
process and handle its IO cancelation. On task cancel event, we are going to call <code>Process#destroy</code> method to stop running in OS.</p>
<pre data-lang="scala" style="background-color:#2e3440;color:#d8dee9;" class="language-scala "><code class="language-scala" data-lang="scala"><span style="color:#81a1c1;">def </span><span style="color:#88c0d0;">startProcess</span><span>(cmd: </span><span style="color:#8fbcbb;">String</span><span>): </span><span style="color:#8fbcbb;">IO</span><span>[</span><span style="color:#81a1c1;">Int</span><span>] </span><span style="color:#81a1c1;">= </span><span>{
</span><span>  </span><span style="color:#81a1c1;">val blockingTask =</span><span> blocker</span><span style="color:#81a1c1;">.</span><span>blockOn(</span><span style="color:#8fbcbb;">IO</span><span>(cmd</span><span style="color:#81a1c1;">.</span><span>run()))
</span><span>  blockingTask</span><span style="color:#81a1c1;">.</span><span>bracketCase { p </span><span style="color:#81a1c1;">=&gt;
</span><span>    </span><span style="color:#8fbcbb;">IO</span><span>(p</span><span style="color:#81a1c1;">.</span><span>exitValue())
</span><span>  } { (p, exit) </span><span style="color:#81a1c1;">=&gt;
</span><span>    exit </span><span style="color:#81a1c1;">match </span><span>{
</span><span>      </span><span style="color:#81a1c1;">case </span><span style="color:#8fbcbb;">Completed </span><span style="color:#81a1c1;">=&gt; </span><span style="color:#8fbcbb;">IO</span><span style="color:#81a1c1;">.</span><span>unit
</span><span>      </span><span style="color:#81a1c1;">case </span><span style="color:#8fbcbb;">Error</span><span>(</span><span style="color:#81a1c1;">_</span><span>) | </span><span style="color:#8fbcbb;">Canceled </span><span style="color:#81a1c1;">=&gt; </span><span style="color:#8fbcbb;">IO</span><span>(p</span><span style="color:#81a1c1;">.</span><span>destroy())
</span><span>    }
</span><span>  }
</span><span>} 
</span></code></pre>
<p>Above pattern matching case on Canceled, we stop process <code>p</code> using <code>destroy()</code>.</p>
<h2 id="run-a-task-with-timeout">Run a task with timeout</h2>
<p>One of the way to run Cats IO with timeout is to use its <code>race</code> method from <code>Concurrent</code> type class. Second
task in race is a call of <code>Timer#sleep</code>, which is semantically blocking an IO for a specified duration.</p>
<p>Let's bring special function to start a race for two IOs and have third task as fallback IO, in case first IO
was not completed before timeout. Below function was reused from Cats-Effect documentation:</p>
<pre data-lang="scala" style="background-color:#2e3440;color:#d8dee9;" class="language-scala "><code class="language-scala" data-lang="scala"><span style="color:#81a1c1;">def </span><span style="color:#88c0d0;">timeoutTo</span><span>[</span><span style="color:#8fbcbb;">F</span><span>[</span><span style="color:#81a1c1;">_</span><span>]</span><span style="color:#eceff4;">, </span><span style="color:#8fbcbb;">A</span><span>](
</span><span>    fa: </span><span style="color:#8fbcbb;">F</span><span>[</span><span style="color:#8fbcbb;">A</span><span>]</span><span style="color:#eceff4;">,
</span><span>    after: </span><span style="color:#8fbcbb;">FiniteDuration</span><span style="color:#eceff4;">,
</span><span>    fallback: </span><span style="color:#8fbcbb;">F</span><span>[</span><span style="color:#8fbcbb;">A</span><span>]
</span><span>  )(</span><span style="color:#81a1c1;">implicit </span><span>timer: </span><span style="color:#8fbcbb;">Timer</span><span>[</span><span style="color:#8fbcbb;">F</span><span>]</span><span style="color:#eceff4;">, </span><span>concurrent: </span><span style="color:#8fbcbb;">Concurrent</span><span>[</span><span style="color:#8fbcbb;">F</span><span>]): </span><span style="color:#8fbcbb;">F</span><span>[</span><span style="color:#8fbcbb;">A</span><span>] </span><span style="color:#81a1c1;">= </span><span>{
</span><span>
</span><span>    concurrent</span><span style="color:#81a1c1;">.</span><span>race(fa</span><span style="color:#eceff4;">,</span><span> timer</span><span style="color:#81a1c1;">.</span><span>sleep(after))</span><span style="color:#81a1c1;">.</span><span>flatMap {
</span><span>      </span><span style="color:#81a1c1;">case </span><span style="color:#8fbcbb;">Left</span><span>(a) </span><span style="color:#81a1c1;">=&gt;
</span><span>        println(</span><span style="color:#a3be8c;">&quot;Done&quot;</span><span>)
</span><span>        concurrent</span><span style="color:#81a1c1;">.</span><span>pure(a)
</span><span>      </span><span style="color:#81a1c1;">case </span><span style="color:#8fbcbb;">Right</span><span>(</span><span style="color:#81a1c1;">_</span><span>) </span><span style="color:#81a1c1;">=&gt;
</span><span>        println(</span><span style="color:#a3be8c;">&quot;Timeout&quot;</span><span>)
</span><span>        fallback
</span><span>    }
</span><span>  }
</span></code></pre>
<p>Now we are ready to run our blocking task with timeout. For the sake of example, we set 1 second as timeout and failing returned IO,
by giving fallback IO with exception. Let us run infinitely running command such <code>tail -f</code> on some file to simulate
long-running task, which we need to cancel in case of timeout.</p>
<pre data-lang="scala" style="background-color:#2e3440;color:#d8dee9;" class="language-scala "><code class="language-scala" data-lang="scala"><span style="color:#81a1c1;">val task =</span><span> startProcess(</span><span style="color:#a3be8c;">&quot;tail -f build.sbt&quot;</span><span>)
</span><span style="color:#81a1c1;">val finalTask =</span><span> timeoutTo(task</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">1</span><span style="color:#81a1c1;">.</span><span>second</span><span style="color:#eceff4;">, 
</span><span>  </span><span style="color:#8fbcbb;">IO</span><span style="color:#81a1c1;">.</span><span>raiseError(</span><span style="color:#81a1c1;">new </span><span style="color:#8fbcbb;">TimeoutException</span><span>(</span><span style="color:#a3be8c;">&quot;Failed to run external process&quot;</span><span>)))
</span><span>finalTask</span><span style="color:#81a1c1;">.</span><span>unsafeRunSync()
</span></code></pre>
<p>Output</p>
<pre data-lang="scala" style="background-color:#2e3440;color:#d8dee9;" class="language-scala "><code class="language-scala" data-lang="scala"><span>scala&gt; finalTask</span><span style="color:#81a1c1;">.</span><span>unsafeRunSync()
</span><span>          </span><span style="color:#616e88;">//... here comes a content of build.sbt as per given command 
</span><span>  
</span><span style="color:#8fbcbb;">Timeout
</span><span>java</span><span style="color:#81a1c1;">.</span><span>util</span><span style="color:#81a1c1;">.</span><span>concurrent</span><span style="color:#81a1c1;">.</span><span style="color:#8fbcbb;">TimeoutException</span><span>: </span><span style="color:#8fbcbb;">Failed to run external process
</span></code></pre>
<p>Happy case:</p>
<pre data-lang="scala" style="background-color:#2e3440;color:#d8dee9;" class="language-scala "><code class="language-scala" data-lang="scala"><span>scala&gt; </span><span style="color:#81a1c1;">val task =</span><span> startProcess(</span><span style="color:#a3be8c;">&quot;echo cats&quot;</span><span>)
</span><span>scala&gt; </span><span style="color:#81a1c1;">val finalTask =</span><span> timeoutTo(task</span><span style="color:#eceff4;">, </span><span style="color:#b48ead;">1</span><span style="color:#81a1c1;">.</span><span>second</span><span style="color:#eceff4;">, 
</span><span>  </span><span style="color:#8fbcbb;">IO</span><span style="color:#81a1c1;">.</span><span>raiseError(</span><span style="color:#81a1c1;">new </span><span style="color:#8fbcbb;">TimeoutException</span><span>(</span><span style="color:#a3be8c;">&quot;Failed to run externall process&quot;</span><span>)))
</span><span>scala&gt; finalTask</span><span style="color:#81a1c1;">.</span><span>unsafeRunSync()
</span><span>cats
</span><span style="color:#8fbcbb;">Done
</span><span>res3: </span><span style="color:#81a1c1;">Int = </span><span style="color:#b48ead;">0
</span></code></pre>
<h2 id="summary">Summary</h2>
<ul>
<li>Using <code>Bracket</code> we can easily catch IO cancelation and release acquired resource.
In the example above, we destroy external process, so that OS resource is released.</li>
<li>Cats <code>Blocker</code> helps us to run blocking tasks safely with regards
to other non-blocking tasks.</li>
<li>And <code>IO.race</code> can be used to simulate timeout, since it cancels race looser.</li>
</ul>
<h2 id="misc">Misc</h2>
<ul id="frontmatter" class="frontmatter frontmatter_page"><li>Photo by Maico Amorim on Unsplash</li></ul>
          </div>
          <div class="container has-text-centered">
            
  <p class="is-size-5">
    Share:
    <a class="link" data-sharer="facebook" data-url='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;scala-ce-timeout&#x2F;' href="javascript:void(0);" title="Share on facebook">
      <span class="icon">
        <i class="fab fa-facebook-square"></i>
      </span>
    </a>
    <a class="link" data-sharer="twitter" data-title='Cats-Effect: Cancel Scala Process on Timeout' data-url='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;scala-ce-timeout&#x2F;' href="javascript:void(0);" title="Share on twitter">
      <span class="icon">
        <i class="fab fa-twitter"></i>
      </span>
    </a>
    <a class="link" data-sharer="linkedin" data-url='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;scala-ce-timeout&#x2F;' href="javascript:void(0);" title="Share on linkedin">
      <span class="icon">
        <i class="fab fa-linkedin"></i>
      </span>
    </a>
    <a class="link" data-sharer="reddit" data-url='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;scala-ce-timeout&#x2F;' href="javascript:void(0);" title="Share on reddit">
      <span class="icon">
        <i class="fab fa-reddit"></i>
      </span>
    </a>
    <a class="link" data-sharer="hackernews" data-title="Cats-Effect: Cancel Scala Process on Timeout" data-url='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;scala-ce-timeout&#x2F;' href="javascript:void(0);" title="Share on hackernews">
      <span class="icon">
        <i class="fab fa-hacker-news"></i>
      </span>
    </a>
    <a class="link" data-sharer="whatsapp" data-title="Cats-Effect: Cancel Scala Process on Timeout" data-url='https:&#x2F;&#x2F;novakov-alexey.github.io&#x2F;scala-ce-timeout&#x2F;' href="javascript:void(0);" title="Share on whatsapp">
      <span class="icon">
        <i class="fab fa-whatsapp-square"></i>
      </span>
    </a>
  </p>

          </div>
        </article>
      </div>
      
      <div class="column is-2 is-hidden-mobile">
        <aside class="menu" style="position: sticky; top: 48px">
          <p class="heading has-text-weight-bold">Contents</p>
          <ul class="menu-list">
            
            <li>
              <a id="link-handle-blocking-code" class="toc is-size-7 is-active" href="https://novakov-alexey.github.io/scala-ce-timeout/#handle-blocking-code">
                Handle blocking code
              </a>
              
            </li>
            
            <li>
              <a id="link-blocking-task" class="toc is-size-7 " href="https://novakov-alexey.github.io/scala-ce-timeout/#blocking-task">
                Blocking Task
              </a>
              
            </li>
            
            <li>
              <a id="link-run-a-task-with-timeout" class="toc is-size-7 " href="https://novakov-alexey.github.io/scala-ce-timeout/#run-a-task-with-timeout">
                Run a task with timeout
              </a>
              
            </li>
            
            <li>
              <a id="link-summary" class="toc is-size-7 " href="https://novakov-alexey.github.io/scala-ce-timeout/#summary">
                Summary
              </a>
              
            </li>
            
            <li>
              <a id="link-misc" class="toc is-size-7 " href="https://novakov-alexey.github.io/scala-ce-timeout/#misc">
                Misc
              </a>
              
            </li>
            
          </ul>
        </aside>
      </div>
      
    </div>
  </div>
</section>
  


  
  <section class="modal" id="search-modal">
    <div class="modal-background"></div>
    <div class="modal-content">
      <div class="field">
        <p class="control has-icons-right">
          <input class="input" id="search" placeholder="Search this website." type="search" />
          <span class="icon is-small is-right">
            <i class="fas fa-search"></i>
          </span>
        </p>
      </div>
      <div class="search-results">
        <div class="search-results__items"></div>
      </div>
    </div>
    <button aria-label="close" class="modal-close is-large"></button>
  </section>
  


  



  
<section class="section">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-6">
        <div id="disqus_thread"></div>
      </div>
    </div>
  </div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    
    var disqus_config = function () {      
      this.page.url = 'https://novakov-alexey.github.io/scala-ce-timeout/';  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = 'scala-ce-timeout'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://novakov-alexey-blog.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>


  
  <footer class="py-4 has-background-light">
    <p class="has-text-centered">
      Built with
      <span class="icon is-small">
        <i class="fas fa-code fa-xs"></i>
      </span>
      code and
      <span class="icon is-small">
        <i class="fas fa-heart fa-xs"></i>
      </span>
      love <br /> Powered By
      <span class="icon is-small">
        <i class="fas fa-power-off fa-xs"></i>
      </span>
      Zola
    </p>
  </footer>
  

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sharer.js@latest/sharer.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/galleria/1.6.1/galleria.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.xkcd@1/dist/chart.xkcd.min.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/v1.12.0/mapbox-gl.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/galleria/1.6.1/themes/folio/galleria.folio.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/elasticlunr/0.9.6/elasticlunr.min.js"></script>
  <script src='https://novakov-alexey.github.io/search_index.en.js'></script>
  <script src='https://novakov-alexey.github.io/js/site.js'></script>

  

<script type="text/javascript">
  const menuBarHeight = $("nav.navbar").height();
  const tocItems = $('.toc');
  const navSections = new Array($('.toc').length);

  tocItems.each(function (i) {
    let id = $(this).attr("id").substring(5);
    navSections[i] = document.getElementById(id);
  })

  function isVisible(tocIndex) {
    const current = navSections[tocIndex];
    const next = tocIndex < tocItems.length - 1 ? navSections[tocIndex+1] : $("section.section").get(1);
    
    const c = current.getBoundingClientRect();
    const n = next.getBoundingClientRect();
    const h = (window.innerHeight || document.documentElement.clientHeight);

    return (c.top <= h) && (c.top + (n.top - c.top) - menuBarHeight >= 0);
  }

  function activateIfVisible() {
    for (b = true, i = 0; i < tocItems.length; i++) {
      if (b && isVisible(i)) {
        tocItems[i].classList.add('is-active');
        b = false;
      } else
        tocItems[i].classList.remove('is-active');
    }
  }

  var isTicking = null;
  window.addEventListener('scroll', () => {
    if (!isTicking) {
      window.requestAnimationFrame(() => {
        activateIfVisible();
        isTicking = false;
      });
      isTicking = true;
    }
  }, false);
</script>




</body>

</html>